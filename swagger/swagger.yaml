---
swagger: '2.0'
info:
  title: v1alpha1/proto/grafeas.proto
  version: version not set
schemes:
  - http
  - https
consumes:
  - application/json
produces:
  - application/json
paths:
  /v1alpha1/projects:
    get:
      summary: Lists `Projects`
      operationId: list_projects
      responses:
        '200':
          description: ''
          schema:
            $ref: '#/definitions/apiListProjectsResponse'
      parameters:
        - name: Account
          description: The unique ID for your cloud account.
          in: header
          type: string
        - name: Authorization
          description: The user authentication agent (UAA) or the Identity & Access Management (IAM) JSON web token
          in: header
          required: true
          type: string
        - name: filter
          description: The filter expression.
          in: query
          required: false
          type: string
        - name: page_size
          description: Number of projects to return in the list.
          in: query
          required: false
          type: integer
          format: int32
        - name: page_token
          description: Token to provide to skip to a particular spot in the list.
          in: query
          required: false
          type: string
      tags:
        - GrafeasProjects
      x-swagger-router-controller: "controllers.grafeas_projects_controller"
    post:
      summary: Creates a new `Project`.
      operationId: create_project
      responses:
        '200':
          description: ''
          schema:
            $ref: '#/definitions/apiEmpty'
      parameters:
        - name: Account
          description: The unique ID for your cloud account.
          in: header
          type: string
        - name: Authorization
          description: The user authentication agent (UAA) or the Identity & Access Management (IAM) JSON web token
          in: header
          required: true
          type: string
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/apiProject'
      tags:
        - GrafeasProjects
      x-swagger-router-controller: "controllers.grafeas_projects_controller"
  /v1alpha1/projects/{project_id}:
    get:
      summary: Returns the requested `Project`.
      operationId: get_project
      responses:
        '200':
          description: ''
          schema:
            $ref: '#/definitions/apiProject'
      parameters:
        - name: Account
          description: The unique ID for your cloud account.
          in: header
          type: string
        - name: Authorization
          description: The user authentication agent (UAA) or the Identity & Access Management (IAM) JSON web token
          in: header
          required: true
          type: string
        - name: project_id
          in: path
          description: "Part of `parent`. This field contains the project_id for example: projects/{project_id}"
          required: true
          type: string
      tags:
        - GrafeasProjects
      x-swagger-router-controller: "controllers.grafeas_projects_controller"
    delete:
      summary: Deletes the given `Project` from the system.
      operationId: delete_project
      responses:
        '200':
          description: ''
          schema:
            $ref: '#/definitions/apiEmpty'
      parameters:
        - name: Account
          description: "The unique ID for your cloud account."
          in: header
          type: string
        - name: Authorization
          description: The user authentication agent (UAA) or the Identity & Access Management (IAM) JSON web token
          in: header
          required: true
          type: string
        - name: project_id
          in: path
          description: "Part of `parent`. This field contains the project_id for example: projects/{project_id}"
          required: true
          type: string
      tags:
        - GrafeasProjects
      x-swagger-router-controller: "controllers.grafeas_projects_controller"

  /v1alpha1/projects/{project_id}/notes:
    get:
      summary: Lists all `Notes` for a given project.
      operationId: list_notes
      responses:
        '200':
          description: ''
          schema:
            $ref: '#/definitions/apiListNotesResponse'
      parameters:
        - name: Account
          description: The unique ID for your cloud account.
          in: header
          type: string
        - name: Authorization
          description: The user authentication agent (UAA) or the Identity & Access Management (IAM) JSON web token
          in: header
          required: true
          type: string
        - name: project_id
          in: path
          description: "Part of `parent`. This field contains the project_id for example: projects/{project_id}"
          required: true
          type: string
        - name: filter
          description: The filter expression.
          in: query
          required: false
          type: string
        - name: page_size
          description: Number of notes to return in the list.
          in: query
          required: false
          type: integer
          format: int32
        - name: page_token
          description: Token to provide to skip to a particular spot in the list.
          in: query
          required: false
          type: string
      tags:
        - GrafeasNotes
      x-swagger-router-controller: "controllers.grafeas_notes_controller"
    post:
      summary: Creates a new `Note`.
      operationId: create_note
      responses:
        '200':
          description: ''
          schema:
            $ref: '#/definitions/apiNote'
      parameters:
        - name: Account
          description: The unique ID for your cloud account.
          in: header
          type: string
        - name: Authorization
          description: The user authentication agent (UAA) or the Identity & Access Management (IAM) JSON web token
          in: header
          required: true
          type: string
        - name: project_id
          in: path
          description: "Part of `parent`. This field contains the project_id for example: projects/{project_id}"
          required: true
          type: string
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/apiNote'
      tags:
        - GrafeasNotes
      x-swagger-router-controller: "controllers.grafeas_notes_controller"
  /v1alpha1/projects/{project_id}/notes/{note_id}:
    get:
      summary: Returns the requested `Note`.
      operationId: get_note
      responses:
        '200':
          description: ''
          schema:
            $ref: '#/definitions/apiNote'
      parameters:
        - name: Account
          description: The unique ID for your cloud account.
          in: header
          type: string
        - name: Authorization
          description: The user authentication agent (UAA) or the Identity & Access Management (IAM) JSON web token
          in: header
          required: true
          type: string
        - name: project_id
          in: path
          description: "First part of note `name`: projects/{project_id}/notes/{note_id}"
          required: true
          type: string
        - name: note_id
          in: path
          description: "Second part of note `name`: projects/{project_id}/notes/{note_id}"
          required: true
          type: string
      tags:
        - GrafeasNotes
      x-swagger-router-controller: "controllers.grafeas_notes_controller"
    put:
      summary: Updates an existing `Note`.
      operationId: update_note
      responses:
        '200':
          description: ''
          schema:
            $ref: '#/definitions/apiNote'
      parameters:
        - name: Account
          description: The unique ID for your cloud account.
          in: header
          type: string
        - name: Authorization
          description: The user authentication agent (UAA) or the Identity & Access Management (IAM) JSON web token
          in: header
          required: true
          type: string
        - name: project_id
          in: path
          description: "First part of note `name`: projects/{project_id}/notes/{note_id}"
          required: true
          type: string
        - name: note_id
          in: path
          description: "Second part of note `name`: projects/{project_id}/notes/{note_id}"
          required: true
          type: string
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/apiNote'
      tags:
        - GrafeasNotes
      x-swagger-router-controller: "controllers.grafeas_notes_controller"
    delete:
      summary: Deletes the given `Note` from the system.
      operationId: delete_note
      responses:
        '200':
          description: ''
          schema:
            $ref: '#/definitions/apiEmpty'
      parameters:
        - name: Account
          description: The unique ID for your cloud account.
          in: header
          type: string
        - name: Authorization
          description: The user authentication agent (UAA) or the Identity & Access Management (IAM) JSON web token
          in: header
          required: true
          type: string
        - name: project_id
          in: path
          description: "First part of note `name`: projects/{project_id}/notes/{note_id}"
          required: true
          type: string
        - name: note_id
          in: path
          description: "Second part of note `name`: projects/{project_id}/notes/{note_id}"
          required: true
          type: string
      tags:
        - GrafeasNotes
      x-swagger-router-controller: "controllers.grafeas_notes_controller"

  /v1alpha1/projects/{project_id}/occurrences/{occurrence_id}/notes:
    get:
      summary: Gets the `Note` attached to the given `Occurrence`.
      operationId: get_occurrence_note
      responses:
        '200':
          description: ''
          schema:
            $ref: '#/definitions/apiNote'
      parameters:
        - name: Account
          description: The unique ID for your cloud account.
          in: header
          type: string
        - name: Authorization
          description: The user authentication agent (UAA) or the Identity & Access Management (IAM) JSON web token
          in: header
          required: true
          type: string
        - name: project_id
          in: path
          description: "First part of occurrence `name`: projects/{project_id}/occurrences/{occurrence_id}"
          required: true
          type: string
        - name: occurrence_id
          in: path
          description: "Second part of occurrence `name`: projects/{project_id}/occurrences/{occurrence_id}"
          required: true
          type: "string"
      tags:
        - GrafeasNotes
      x-swagger-router-controller: "controllers.grafeas_notes_controller"

  /v1alpha1/projects/{project_id}/occurrences:
    get:
      summary: Lists active `Occurrences` for a given project matching the filters.
      operationId: list_occurrences
      responses:
        '200':
          description: ''
          schema:
            $ref: '#/definitions/apiListOccurrencesResponse'
      parameters:
        - name: Account
          description: The unique ID for your cloud account.
          in: header
          type: string
        - name: Authorization
          description: The user authentication agent (UAA) or the Identity & Access Management (IAM) JSON web token
          in: header
          required: true
          type: string
        - name: project_id
          in: path
          description: "Part of `parent`. This contains the project_id for example: projects/{project_id}"
          required: true
          type: string
        - name: filter
          description: The filter expression.
          in: query
          required: false
          type: string
        - name: page_size
          description: Number of occurrences to return in the list.
          in: query
          required: false
          type: integer
          format: int32
        - name: page_token
          description: Token to provide to skip to a particular spot in the list.
          in: query
          required: false
          type: string
      tags:
        - GrafeasOccurrences
      x-swagger-router-controller: "controllers.grafeas_occurrences_controller"
    post:
      summary: |-
        Creates a new `Occurrence`. Use this method to create `Occurrences`
        for a resource.
      operationId: create_occurrence
      responses:
        '200':
          description: ''
          schema:
            $ref: '#/definitions/apiOccurrence'
      parameters:
        - name: Account
          description: The unique ID for your cloud account.
          in: header
          type: string
        - name: Authorization
          description: The user authentication agent (UAA) or the Identity & Access Management (IAM) JSON web token
          in: header
          required: true
          type: string
        - name: project_id
          in: path
          description: "Part of `parent`. This contains the project_id for example: projects/{project_id}"
          required: true
          type: string
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/apiOccurrence'
      tags:
        - GrafeasOccurrences
      x-swagger-router-controller: "controllers.grafeas_occurrences_controller"

  /v1alpha1/projects/{project_id}/occurrences/{occurrence_id}:
    get:
      summary: Returns the requested `Occurrence`.
      operationId: get_occurrence
      responses:
        '200':
          description: ''
          schema:
            $ref: '#/definitions/apiOccurrence'
      parameters:
        - name: Account
          description: The unique ID for your cloud account.
          in: header
          type: string
        - name: Authorization
          description: The user authentication agent (UAA) or the Identity & Access Management (IAM) JSON web token
          in: header
          required: true
          type: string
        - name: project_id
          in: path
          description: "First part of occurrence `name`: projects/{project_id}/occurrences/{occurrence_id}"
          required: true
          type: string
        - name: occurrence_id
          in: path
          description: "Second part of occurrence `name`: projects/{project_id}/occurrences/{occurrence_id}"
          required: true
          type: string
      tags:
        - GrafeasOccurrences
      x-swagger-router-controller: "controllers.grafeas_occurrences_controller"
    put:
      summary: Updates an existing `Occurrence`.
      operationId: update_occurrence
      responses:
        '200':
          description: ''
          schema:
            $ref: '#/definitions/apiOccurrence'
      parameters:
        - name: Account
          description: The unique ID for your cloud account.
          in: header
          type: string
        - name: Authorization
          description: The user authentication agent (UAA) or the Identity & Access Management (IAM) JSON web token
          in: header
          required: true
          type: string
        - name: project_id
          in: path
          description: "First part of occurrence `name`: projects/{project_id}/occurrences/{occurrence_id}"
          required: true
          type: string
        - name: occurrence_id
          in: path
          description: "Second part of occurrence `name`: projects/{project_id}/occurrences/{occurrence_id}"
          required: true
          type: string
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/apiNote'
      tags:
        - GrafeasOccurrences
      x-swagger-router-controller: "controllers.grafeas_occurrences_controller"
    delete:
      summary: Deletes the given `Occurrence` from the system.
      operationId: delete_occurrence
      responses:
        '200':
          description: ''
          schema:
            $ref: '#/definitions/apiEmpty'
      parameters:
        - name: Account
          description: The unique ID for your cloud account.
          in: header
          type: string
        - name: Authorization
          description: The user authentication agent (UAA) or the Identity & Access Management (IAM) JSON web token
          in: header
          required: true
          type: string
        - name: project_id
          in: path
          description: "First part of occurrence `name`: projects/{project_id}/notes/{occurrence_id}"
          required: true
          type: string
        - name: occurrence_id
          in: path
          description: "Second part of occurrence `name`: projects/{project_id}/notes/{occurrence_id}"
          required: true
          type: string
      tags:
        - GrafeasOccurrences
      x-swagger-router-controller: "controllers.grafeas_occurrences_controller"

  /v1alpha1/projects/{project_id}/notes/{note_id}/occurrences:
    get:
      summary: |-
        Lists `Occurrences` referencing the specified `Note`. Use this method to
        get all occurrences referencing your `Note` across all your customer
        projects.
      operationId: list_note_occurrences
      responses:
        '200':
          description: ''
          schema:
            $ref: '#/definitions/apiListNoteOccurrencesResponse'
      parameters:
        - name: Account
          description: The unique ID for your cloud account.
          in: header
          type: string
        - name: Authorization
          description: The user authentication agent (UAA) or the Identity & Access Management (IAM) JSON web token
          in: header
          required: true
          type: string
        - name: project_id
          in: path
          description: "First part of note `name`: projects/{project_id}/notes/{note_id}"
          required: true
          type: string
        - name: note_id
          in: path
          description: "Second part of note `name`: projects/{project_id}/notes/{note_id}"
          required: true
          type: string
        - name: filter
          description: The filter expression.
          in: query
          required: false
          type: string
        - name: page_size
          description: Number of notes to return in the list.
          in: query
          required: false
          type: integer
          format: int32
        - name: page_token
          description: Token to provide to skip to a particular spot in the list.
          in: query
          required: false
          type: string
      tags:
        - GrafeasOccurrences
      x-swagger-router-controller: "controllers.grafeas_occurrences_controller"

definitions:
  apiCertainty:
    type: string
    enum:
      - LOW
      - MEDIUM
      - HIGH
    description: |-
      Note provider-assigned confidence on the validity of an occurrence
      - LOW&#58; Low Certainty
      - MEDIUM&#58; Medium Certainty
      - HIGH&#58; High Certainty

  apiEmpty:
    type: object
    description: |-
      A generic empty message that you can re-use to avoid defining duplicated
      empty messages in your APIs. A typical example is to use it as the request
      or the response type of an API method.
      The JSON representation for `Empty` is empty JSON object `{}`.

  apiListNoteOccurrencesResponse:
    type: object
    properties:
      occurrences:
        type: array
        items:
          $ref: '#/definitions/apiOccurrence'
        description: The occurrences attached to the specified note.
      next_page_token:
        type: string
        description: Token to receive the next page of notes.
    description: Response including listed occurrences for a note.

  apiListNotesResponse:
    type: object
    properties:
      notes:
        type: array
        items:
          $ref: '#/definitions/apiNote'
        title: The occurrences requested
      next_page_token:
        type: string
        description: |-
          The next pagination token in the list response. It should be used as
          page_token for the following request. An empty value means no more result.
    description: Response including listed notes.

  apiListOccurrencesResponse:
    type: object
    properties:
      occurrences:
        type: array
        items:
          $ref: '#/definitions/apiOccurrence'
        description: The occurrences requested.
      next_page_token:
        type: string
        description: |-
          The next pagination token in the list response. It should be used as
          `page_token` for the following request. An empty value means no more
          results.
    description: Response including listed active occurrences.

  apiListProjectsResponse:
    type: object
    properties:
      projects:
        type: array
        items:
          $ref: '#/definitions/apiProject'
        description: The projects requested.
      next_page_token:
        type: string
        description: |-
          The next pagination token in the list response. It should be used as
          `page_token` for the following request. An empty value means no more
          results.
    description: Response including listed projects

  apiNote:
    type: object
    properties:
      project_id:
        type: string
        title: The project id of the note
      id:
        type: string
        title: The id of the note
      name:
        type: string
        title: |-
          The name of the note in the form "projects/{project_id}/notes/{note_id}"
      short_description:
        type: string
        description: A one sentence description of this `Note`.
      long_description:
        type: string
        description: A detailed description of this `Note`.
      kind:
        $ref: '#/definitions/apiNoteKind'
        description: |-
          Output only. This explicitly denotes which kind of note is specified. This
          field can be used as a filter in list requests.
      related_url:
        type: array
        items:
          $ref: '#/definitions/apiNoteRelatedUrl'
        title: URLs associated with this note
      expiration_time:
        type: string
        format: date-time
        description: 'Time of expiration for this note, null if note does not expire.'
      create_time:
        type: string
        format: date-time
        description: |-
          Output only. The time this note was created.
          This field can be used as a filter in list requests.
      update_time:
        type: string
        format: date-time
        description: |-
          Output only. The time this note was last updated.
          This field can be used as a filter in list requests.

      #
      # IBM extensions start here
      #
      reported_by:
        $ref: '#/definitions/apiReporter'
        description: Details about the reporter of this `Note`.
      finding_type:
        $ref: '#/definitions/FindingType'
        description: A finding type of note.
      kpi_type:
        $ref: '#/definitions/KpiType'
        description: A KPI type of note.
      #
      # IBM extensions stop here
      #
    description: Provides a detailed description of a `Note`.

  apiNoteKind:
    type: string
    enum:
      - FINDING
      - KPI
    description: |-
      This must be 1&#58;1 with members of our oneofs, it can be used for filtering Note and Occurrence on their kind.
       - FINDING&#58; The note and occurrence represent a finding.
       - KPI&#58; The note and occurrence represent a KPI.

  apiNoteRelatedUrl:
    type: object
    properties:
      url:
        type: string
        title: Specific URL to associate with the note
      label:
        type: string
        title: Label to describe usage of the URL
    description: Metadata for any related URL information

  apiOccurrence:
    type: object
    properties:
      project_id:
        type: string
        title: The project id of the occurrence
      id:
        type: string
        title: The id of the occurrence
      name:
        type: string
        description: |-
          Output only. The name of the `Occurrence` in the form "projects/{project_id}/occurrences/{occuurence_id}"
      resource_url:
        type: string
        description: |-
          The unique URL of the resource, image or the container, for which the `Occurrence` applies.
          For example, https://gcr.io/project/image@sha256:foo.
          This field can be used as a filter in list requests.
      note_name:
        type: string
        description: |-
          An analysis note associated with this image, in the form "projects/{project_id}/notes/{note_id}"
          This field can be used as a filter in list requests.
      kind:
        $ref: '#/definitions/apiNoteKind'
        description: |-
          Output only. This explicitly denotes which of the `Occurrence` details are specified.
          This field can be used as a filter in list requests.
      remediation:
        type: string
        title: A description of actions that can be taken to remedy the `Note`
      create_time:
        type: string
        format: date-time
        description: Output only. The time this `Occurrence` was created.
      update_time:
        type: string
        format: date-time
        description: Output only. The time this `Occurrence` was last updated.

      #
      # IBM extensions start here
      #
      short_description:
        type: string
        description: A one sentence description of this `Occurrence`.
      long_description:
        type: string
        description: A detailed description of this `Occurrence`.
      context:
        $ref: '#/definitions/apiContext'
        description: Details about the context of this `Occurrence`
      finding:
        $ref: '#/definitions/Finding'
        description: Details of the occurrence of a finding.
      kpi:
        $ref: '#/definitions/Kpi'
        description: Details of the occurrence of a KPI.
      #
      # IBM extensions stop here
      #
    description: '`Occurrence` includes information about analysis occurrences for an image.'

  apiProject:
    type: object
    properties:
      id:
        type: string
        title: The id of the project
      name:
        type: string
        title: The name of the project of the form "projects/{project_id}"
    description: Provides detailed description of a `Project`.

  apiContext:
    type: object
    properties:
      account:
        type: string
        description: The account of the resource this occurrence applies to
      region:
        type: string
        description: The region of the resource this occurrence applies to
      resource:
        type: string
        description: The resource this occurrence applies to
      resource_group:
        type: string
        description: The resource group this occurrence applies to
      resource_type:
        type: string
        description: A user-friendly resource type name
      service:
        type: string
        description: The managing service of the resource this occurrence applies to
      environment:
        type: string
        description: The environment name of the resource this occurrence applies to
      component:
        type: string
        description: The component name of the resource this occurrence applies to
      toolchain:
        type: string
        description: The toolchain managing the resource this occurrence applies to

  apiReporter:
    type: object
    description: The entity reporting a note
    properties:
      id:
        type: string
        description: The id of this reporter
      title:
        type: string
        description: The title of this reporter
      href:
        type: string
        description: The href of this reporter

  apiSeverity:
    type: string
    enum:
      - LOW
      - MEDIUM
      - HIGH
    description: |-
      Note provider-assigned severity/impact ranking
      - LOW&#58; Low Impact
      - MEDIUM&#58; Medium Impact
      - HIGH&#58; High Impact

#
# Finding note and occurrence definitions
#
  FindingType:
    type: object
    description: FindingType provides details about a finding note.
    properties:
      title_id:
        type: string
        description: The title ID of this finding type (for internationalization)
      default_title:
        type: string
        description: The default title of this finding type
      default_severity:
        $ref: '#/definitions/apiSeverity'
        description: The default severity of the findings related to this `Note`
      elements:
        type: array
        items:
          $ref: '#/definitions/FindingTypeElement'
        description: The elements of this `FindingType`

  FindingTypeElement:
    type: object
    description: FindingTypeElement provides details about the elements of a FindingType
    properties:
      kind:
        type: string
        enum:
        - SINGLE_VALUE
        - MULTI_VALUE_HISTOGRAM
        description: |-
          Kind of element
          - SINGLE_VALUE&#58; Single value
          - MULTI_VALUE_HISTOGRAM&#58; Multi values shown in a histogram
      note_names:
        type: array
        description: The names of the notes associated to the 'FindingType'
        items:
          type: string

  Finding:
    type: object
    description: Finding provides details about a finding occurrence.
    properties:
      severity:
        $ref: '#/definitions/apiSeverity'
        description: The common severity of this `Occurrence`
      certainty:
        $ref: '#/definitions/apiCertainty'
        description: The confidence level on this `Occurrence`
#
# KPI note and occurrence definitions
#
  KpiType:
    type: object
    description: KpiType provides details about a KPI note.
    properties:
      label_id:
        type: string
        description: The label ID of this KPI type (for internationalization)
      default_label:
        type: string
        description: The default label of this KPI type
      description_id:
        type: string
        description: The description ID of this KPI type (for internationalization)
      default_description:
        type: string
        description: The default description of this KPI type
      aggregation_type:
        type: string
        enum:
        - SUM
        description: |-
          The aggregation type of the KPI values.
          - SUM&#58; A single-value metrics aggregation type that sums up numeric values
            that are extracted from KPI occurrences.
        default: SUM

  Kpi:
    type: object
    description: Kpi provides details about a KPI occurrence.
    properties:
      value:
        type: number
        description: The value of this KPI
      total:
        type: number
        description: The total value of this KPI
